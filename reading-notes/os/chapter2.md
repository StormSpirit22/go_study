# 第一部分：虚拟化

## 第二章：操作系统介绍

操作系统将物理（physical）资源（如处理器、内存或磁盘）转换为更通用、更强大且更易于使用的虚拟形式。因此，我们有时将操作系统称为虚拟机（virtual machine）

每个进程访问自己的私有虚拟地址空间（virtual address space）（有时称为地址空间，address space），操作系统以某种方式映射到机器的物理内存上。一个正在运行的程序中的内存引用不会影响其他进程（或操作系统本身）的地址空间。对于正在运行的程序，它完全拥有自己的物理内存。

## 第四章：抽象进程

通过让一个进程只运行一个时间片，然后切换到其他进程，操作系统提供了存在多个虚拟CPU的假象。这就是时分共享（time sharing）CPU技术，允许用户如愿运行多个并发进程。潜在的开销就是性能损失，因为如果CPU必须共享，每个进程的运行就会慢一点。

#### 进程概念

操作系统为正在运行的程序提供的抽象，就是所谓的进程（process）。

进程的机器状态组成部分：

- 内存，即地址空间（address space）。
- 寄存器。一些特殊的寄存器：程序计数器（Program Counter，PC）（有时称为指令指针，Instruction Pointer或IP）告诉我们程序当前正在执行哪个指令；栈指针（stack pointer）和相关的帧指针（frame pointer）用于管理函数参数栈、局部变量和返回地址。
- 持久存储设备。

### 进程创建

1. 将代码和静态数据加载到内存中。
2. 为程序的运行时栈（run-time stack或stack）分配内存。C程序使用栈存放局部变量、函数参数和返回地址。
3. 也可能为程序的堆（heap）分配一些内存。堆用于显式请求的动态分配数据。malloc() 和 free()。
4. 执行与I/O设置相关的其他工作。在UNIX系统中，默认情况下每个进程都有3个打开的文件描述符（filedescriptor），用于标准输入、输出和错误。

### 进程状态

- 运行（running）：在运行状态下，进程正在处理器上运行。这意味着它正在执行指令。
- 就绪（ready）：在就绪状态下，进程已准备好运行，但由于某种原因，操作系统选择不在此时运行。
- 阻塞（blocked）：在阻塞状态下，一个进程执行了某种操作，直到发生其他事件时才会准备运行。一个常见的例子是，当进程向磁盘发起I/O请求时，它会被阻塞，因此其他进程可以使用处理器。